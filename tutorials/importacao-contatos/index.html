<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Como Importar Contatos | Full Funnel</title>
<style>
  :root {
    --primary: #7c3aed;
    --primary-light: #a78bfa;
    --highlight: #ef4444;
    --bg: #0f0f1a;
    --card-bg: #1a1a2e;
    --text: #e2e8f0;
    --text-muted: #94a3b8;
    --border: #2d2d44;
    --tooltip-bg: #ffffff;
    --tooltip-text: #1e293b;
    --radius: 12px;
    --shadow: 0 20px 60px rgba(0,0,0,0.5);
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
    background: var(--bg); color: var(--text);
    min-height: 100vh;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    overflow: hidden;
  }

  /* Header */
  .header {
    position: fixed; top: 0; left: 0; right: 0;
    padding: 16px 24px;
    display: flex; align-items: center; justify-content: space-between;
    background: rgba(15,15,26,0.9); backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border); z-index: 100;
  }
  .header-brand { display: flex; align-items: center; gap: 10px; font-weight: 700; font-size: 16px; color: var(--primary-light); }
  .header-brand svg { width: 24px; height: 24px; }
  .header-title { font-size: 14px; color: var(--text-muted); }
  .header-steps { font-size: 13px; color: var(--text-muted); background: var(--card-bg); padding: 6px 14px; border-radius: 20px; border: 1px solid var(--border); }

  /* Container */
  .container { width: 100%; max-width: 1200px; padding: 80px 24px 120px; position: relative; }

  /* Screenshot */
  .screenshot-wrapper {
    position: relative; width: 100%;
    border-radius: var(--radius); overflow: visible;
    box-shadow: var(--shadow); border: 1px solid var(--border);
    background: var(--card-bg);
  }
  .screenshot-wrapper img { width: 100%; display: block; border-radius: var(--radius); transition: opacity 0.4s ease; }
  .screenshot-wrapper img.fade-out { opacity: 0; }
  .screenshot-wrapper img.fade-in { opacity: 1; }

  /* Highlight Frame - ret√¢ngulo de destaque no ponto de clique */
  .click-highlight {
    position: absolute;
    border: 3px solid var(--highlight);
    border-radius: 8px;
    background: rgba(239, 68, 68, 0.08);
    transition: all 0.4s ease;
    z-index: 10;
    pointer-events: none;
  }
  .click-highlight::after {
    content: '';
    position: absolute; inset: -6px;
    border: 2px solid rgba(239, 68, 68, 0.3);
    border-radius: 11px;
    animation: frame-pulse 2s ease-in-out infinite;
  }
  @keyframes frame-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }

  /* SVG Arrow Line */
  .arrow-svg {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
    z-index: 15;
    overflow: visible;
  }
  .arrow-line {
    stroke: var(--highlight);
    stroke-width: 2;
    fill: none;
    stroke-dasharray: 6 4;
    opacity: 0.7;
  }
  .arrow-dot {
    fill: var(--highlight);
    opacity: 0.9;
  }

  /* Tooltip - agora posicionado em √°rea segura */
  .tooltip {
    position: absolute;
    z-index: 20;
    background: var(--tooltip-bg); color: var(--tooltip-text);
    padding: 20px 24px; border-radius: 12px;
    box-shadow: 0 12px 40px rgba(0,0,0,0.3);
    max-width: 340px; min-width: 260px;
    transition: all 0.4s ease;
  }
  .tooltip-step {
    display: inline-block; background: var(--primary); color: white;
    font-size: 11px; font-weight: 700; padding: 3px 8px; border-radius: 4px;
    margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;
  }
  .tooltip-title { font-size: 16px; font-weight: 700; margin-bottom: 8px; line-height: 1.3; }
  .tooltip-text { font-size: 13px; color: #64748b; line-height: 1.6; }
  .tooltip-tip {
    margin-top: 12px; padding: 10px 12px;
    background: #f0f9ff; border-left: 3px solid #3b82f6;
    border-radius: 4px; font-size: 12px; color: #1e40af; line-height: 1.5;
  }

  /* Navigation */
  .nav-bar {
    position: fixed; bottom: 0; left: 0; right: 0;
    padding: 16px 24px;
    display: flex; align-items: center; justify-content: space-between;
    background: rgba(15,15,26,0.95); backdrop-filter: blur(12px);
    border-top: 1px solid var(--border); z-index: 100;
  }
  .nav-btn {
    padding: 10px 24px; border-radius: 8px;
    border: 1px solid var(--border); background: var(--card-bg); color: var(--text);
    font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s;
    display: flex; align-items: center; gap: 8px;
  }
  .nav-btn:hover { background: #252540; border-color: var(--primary); }
  .nav-btn:disabled { opacity: 0.3; cursor: not-allowed; }
  .nav-btn:disabled:hover { background: var(--card-bg); border-color: var(--border); }
  .nav-btn.primary { background: var(--primary); border-color: var(--primary); color: white; }
  .nav-btn.primary:hover { background: #6d28d9; }

  /* Progress */
  .progress { display: flex; align-items: center; gap: 6px; }
  .progress-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--border); transition: all 0.3s; cursor: pointer; }
  .progress-dot.active { background: var(--primary); width: 24px; border-radius: 4px; }
  .progress-dot.completed { background: var(--primary-light); }

  /* Intro */
  .intro-overlay {
    position: fixed; inset: 0; background: rgba(15,15,26,0.95);
    display: flex; align-items: center; justify-content: center;
    z-index: 200; transition: opacity 0.4s;
  }
  .intro-overlay.hidden { opacity: 0; pointer-events: none; }
  .intro-card {
    background: var(--card-bg); border: 1px solid var(--border);
    border-radius: 16px; padding: 40px; text-align: center;
    max-width: 500px; box-shadow: var(--shadow);
  }
  .intro-card h1 {
    font-size: 24px; margin-bottom: 12px;
    background: linear-gradient(135deg, var(--primary-light), #f472b6);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  }
  .intro-card p { color: var(--text-muted); font-size: 15px; margin-bottom: 8px; line-height: 1.5; }
  .intro-card .steps-count { font-size: 13px; color: var(--text-muted); margin-bottom: 24px; }
  .intro-start {
    padding: 12px 32px; border-radius: 8px; border: none;
    background: var(--primary); color: white; font-size: 16px; font-weight: 700;
    cursor: pointer; transition: background 0.2s;
  }
  .intro-start:hover { background: #6d28d9; }

  @media (max-width: 768px) {
    .container { padding: 70px 12px 100px; }
    .tooltip { max-width: 260px; min-width: 200px; padding: 14px 16px; }
    .tooltip-title { font-size: 14px; }
    .tooltip-text { font-size: 12px; }
    .header-title { display: none; }
    .nav-btn { padding: 8px 16px; font-size: 13px; }
  }
</style>
</head>
<body>

<div class="intro-overlay" id="intro">
  <div class="intro-card">
    <h1>üì• Como Importar Contatos</h1>
    <p>Aprenda a importar sua lista de contatos via arquivo CSV no Full Funnel. Ideal para migrar leads de outras plataformas ou planilhas.</p>
    <p class="steps-count">üìã 7 passos ‚Ä¢ ‚è±Ô∏è ~3 min</p>
    <button class="intro-start" onclick="startTutorial()">Come√ßar Tutorial ‚Üí</button>
  </div>
</div>

<div class="header">
  <div class="header-brand">
    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
    Full Funnel
  </div>
  <div class="header-title">Como Importar Contatos</div>
  <div class="header-steps" id="header-steps">Passo 1 de 7</div>
</div>

<div class="container">
  <div class="screenshot-wrapper" id="screenshot-wrapper">
    <img id="screenshot" src="" alt="Screenshot do passo">
    
    <!-- Frame de destaque no ponto de clique -->
    <div class="click-highlight" id="click-highlight"></div>
    
    <!-- Linha SVG conectando tooltip ao destaque -->
    <svg class="arrow-svg" id="arrow-svg">
      <line class="arrow-line" id="arrow-line" x1="0" y1="0" x2="0" y2="0"/>
      <circle class="arrow-dot" id="arrow-dot-start" r="4" cx="0" cy="0"/>
      <circle class="arrow-dot" id="arrow-dot-end" r="6" cx="0" cy="0"/>
    </svg>
    
    <!-- Tooltip em √°rea segura -->
    <div class="tooltip" id="tooltip">
      <div class="tooltip-step" id="tooltip-step"></div>
      <div class="tooltip-title" id="tooltip-title"></div>
      <div class="tooltip-text" id="tooltip-text"></div>
      <div class="tooltip-tip" id="tooltip-tip" style="display:none;"></div>
    </div>
  </div>
</div>

<div class="nav-bar">
  <button class="nav-btn" id="btn-prev" onclick="prevStep()">‚Üê Anterior</button>
  <div class="progress" id="progress"></div>
  <button class="nav-btn primary" id="btn-next" onclick="nextStep()">Pr√≥ximo ‚Üí</button>
</div>

<script>
const STEPS = [
  {
    image: "passo-01.png",
    highlight: { x: 0, y: 25, w: 13, h: 5 },
    tooltipPos: "right-center",
    title: "Clique em \"Contatos\"",
    text: "No menu lateral, clique em 'Contatos'. √â aqui que ficam todos os seus leads e clientes.",
    tip: null
  },
  {
    image: "passo-01.png",
    highlight: { x: 66, y: 19, w: 8, h: 4 },
    tooltipPos: "left-center",
    title: "Clique em \"Importar\"",
    text: "No canto superior direito, clique no bot√£o 'Importar'. Ele abre o assistente de importa√ß√£o.",
    tip: "üí° Verifique seus contatos existentes antes de importar para evitar duplicatas."
  },
  {
    image: "passo-02.png",
    highlight: { x: 9, y: 35, w: 45, h: 15 },
    tooltipPos: "right-center",
    title: "Selecione \"Contatos\"",
    text: "Escolha o tipo 'Contatos' (pessoas). A op√ß√£o 'Leads' √© para negocia√ß√µes de vendas ‚Äî n√£o selecione essa.",
    tip: null
  },
  {
    image: "passo-02.png",
    highlight: { x: 88, y: 92, w: 10, h: 5 },
    tooltipPos: "left-center",
    title: "Clique em \"Seguinte\"",
    text: "Com 'Contatos' selecionado, clique no bot√£o azul 'Seguinte' para avan√ßar.",
    tip: null
  },
  {
    image: "passo-03.png",
    highlight: { x: 30, y: 38, w: 40, h: 24 },
    tooltipPos: "right-top",
    title: "Envie seu arquivo CSV",
    text: "Arraste seu arquivo para a √°rea pontilhada ou clique nela para selecionar. O formato aceito √© CSV (at√© 30 MB).",
    tip: "üí° CSV √© um tipo de planilha. No Excel ou Google Sheets: Arquivo > Salvar como > CSV."
  },
  {
    image: "passo-03.png",
    highlight: { x: 30, y: 52, w: 40, h: 5 },
    tooltipPos: "right-center",
    title: "Seu arquivo precisa de cabe√ßalhos",
    text: "A primeira linha do CSV deve ter os nomes das colunas: nome, email, telefone. Sem isso, o sistema n√£o reconhece os dados.",
    tip: "üí° Clique em 'Baixar arquivo de amostra' para ver o formato correto."
  },
  {
    image: "passo-03.png",
    highlight: { x: 30, y: 60, w: 40, h: 8 },
    tooltipPos: "right-center",
    title: "Escolha como importar",
    text: "Em 'Selecionar como importar contatos', mantenha 'Crie e atualize contatos'. Isso cria novos e atualiza os que j√° existem.",
    tip: null
  },
  {
    image: "passo-05.png",
    highlight: { x: 10, y: 68, w: 80, h: 25 },
    tooltipPos: "left-top",
    title: "Confira o mapeamento",
    text: "O sistema conecta cada coluna do seu arquivo a um campo da plataforma. Os mais comuns (nome, email, telefone) j√° v√™m mapeados automaticamente.",
    tip: null
  },
  {
    image: "passo-05.png",
    highlight: { x: 10, y: 68, w: 80, h: 25 },
    tooltipPos: "left-top",
    title: "Ajuste campos pendentes",
    text: "Se alguma coluna aparecer como 'Pending', selecione o campo correto no dropdown. Campos personalizados precisam ser criados antes em Configura√ß√µes.",
    tip: "‚ö†Ô∏è Colunas sem campo correspondente ser√£o ignoradas na importa√ß√£o."
  },
  {
    image: "passo-05.png",
    highlight: { x: 90, y: 90, w: 8, h: 6 },
    tooltipPos: "left-center",
    title: "Confirme a importa√ß√£o",
    text: "Clique em 'Seguinte' para ver o resumo. Confira os n√∫meros e clique em 'Confirmar'. Os contatos aparecer√£o na lista em segundos.",
    tip: "‚ö†Ô∏è A importa√ß√£o n√£o pode ser desfeita. Teste primeiro com um arquivo pequeno (5-10 contatos)."
  }
];

let currentStep = 0;

function init() {
  const progress = document.getElementById('progress');
  STEPS.forEach((_, i) => {
    const dot = document.createElement('div');
    dot.className = 'progress-dot';
    dot.onclick = () => goToStep(i);
    progress.appendChild(dot);
  });
}

function startTutorial() {
  document.getElementById('intro').classList.add('hidden');
  goToStep(0);
}

function getTooltipPosition(pos, wrapper) {
  const rect = wrapper.getBoundingClientRect();
  const w = rect.width;
  const h = rect.height;
  const tooltipW = 340;
  const tooltipH = 280;
  const pad = 20;

  switch(pos) {
    case 'left-top':
      return { left: pad + 'px', top: pad + 'px' };
    case 'left-center':
      return { left: pad + 'px', top: '50%', transform: 'translateY(-50%)' };
    case 'left-bottom':
      return { left: pad + 'px', bottom: pad + 'px' };
    case 'right-center':
      return { right: pad + 'px', top: '50%', transform: 'translateY(-50%)' };
    case 'right-top':
      return { right: pad + 'px', top: pad + 'px' };
    case 'center-top':
      return { left: '50%', top: pad + 'px', transform: 'translateX(-50%)' };
    case 'center-bottom':
      return { left: '50%', bottom: pad + 'px', transform: 'translateX(-50%)' };
    default:
      return { left: pad + 'px', top: pad + 'px' };
  }
}

function goToStep(index) {
  if (index < 0 || index >= STEPS.length) return;
  const step = STEPS[index];
  const img = document.getElementById('screenshot');
  const highlight = document.getElementById('click-highlight');
  const tooltip = document.getElementById('tooltip');
  const wrapper = document.getElementById('screenshot-wrapper');

  img.classList.add('fade-out');
  img.classList.remove('fade-in');

  setTimeout(() => {
    // Robust arrow update: triple rAF + fallback timeout
    function scheduleArrowUpdate(step) {
      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          requestAnimationFrame(() => {
            updateArrow(step);
          });
        });
      });
      // Fallback in case rAF fires before full layout
      setTimeout(() => updateArrow(step), 500);
    }

    img.src = step.image;
    img.onload = () => scheduleArrowUpdate(step);
    // If image is cached and onload doesn't fire
    if (img.complete && img.naturalWidth > 0) {
      scheduleArrowUpdate(step);
    }
    img.classList.remove('fade-out');
    img.classList.add('fade-in');

    // Position highlight frame
    const h = step.highlight;
    highlight.style.left = h.x + '%';
    highlight.style.top = h.y + '%';
    highlight.style.width = h.w + '%';
    highlight.style.height = h.h + '%';

    // Position tooltip in safe area
    const tPos = getTooltipPosition(step.tooltipPos, wrapper);
    tooltip.style.left = tPos.left || 'auto';
    tooltip.style.right = tPos.right || 'auto';
    tooltip.style.top = tPos.top || 'auto';
    tooltip.style.bottom = tPos.bottom || 'auto';
    tooltip.style.transform = tPos.transform || 'none';

    // Update tooltip content
    document.getElementById('tooltip-step').textContent = `Passo ${index + 1} de ${STEPS.length}`;
    document.getElementById('tooltip-title').textContent = step.title;
    document.getElementById('tooltip-text').textContent = step.text;
    const tipEl = document.getElementById('tooltip-tip');
    if (step.tip) { tipEl.textContent = step.tip; tipEl.style.display = 'block'; }
    else { tipEl.style.display = 'none'; }

    // Update header + progress
    document.getElementById('header-steps').textContent = `Passo ${index + 1} de ${STEPS.length}`;
    document.querySelectorAll('.progress-dot').forEach((dot, i) => {
      dot.className = 'progress-dot';
      if (i < index) dot.classList.add('completed');
      if (i === index) dot.classList.add('active');
    });

    // Update nav buttons
    document.getElementById('btn-prev').disabled = index === 0;
    const btnNext = document.getElementById('btn-next');
    if (index === STEPS.length - 1) {
      btnNext.innerHTML = '‚úÖ Concluir';
      btnNext.onclick = () => { goToStep(0); document.getElementById('intro').classList.remove('hidden'); };
    } else {
      btnNext.innerHTML = 'Pr√≥ximo ‚Üí';
      btnNext.onclick = nextStep;
    }

    currentStep = index;

    // Draw arrow after layout settles
    requestAnimationFrame(() => requestAnimationFrame(() => updateArrow(step)));
  }, 200);
}

function updateArrow(step) {
  const wrapper = document.getElementById('screenshot-wrapper');
  const tooltip = document.getElementById('tooltip');
  const highlight = document.getElementById('click-highlight');
  const line = document.getElementById('arrow-line');
  const dotStart = document.getElementById('arrow-dot-start');
  const dotEnd = document.getElementById('arrow-dot-end');

  const wRect = wrapper.getBoundingClientRect();
  const tRect = tooltip.getBoundingClientRect();
  const hRect = highlight.getBoundingClientRect();

  // Arrow start: edge of tooltip closest to highlight
  const tCx = tRect.left + tRect.width / 2 - wRect.left;
  const tCy = tRect.top + tRect.height / 2 - wRect.top;

  // Arrow end: center of highlight
  const hCx = hRect.left + hRect.width / 2 - wRect.left;
  const hCy = hRect.top + hRect.height / 2 - wRect.top;

  // Find the edge point of tooltip closest to highlight
  const angle = Math.atan2(hCy - tCy, hCx - tCx);
  const startX = tCx + Math.cos(angle) * Math.min(tRect.width / 2, 170);
  const startY = tCy + Math.sin(angle) * Math.min(tRect.height / 2, 140);

  line.setAttribute('x1', startX);
  line.setAttribute('y1', startY);
  line.setAttribute('x2', hCx);
  line.setAttribute('y2', hCy);

  dotStart.setAttribute('cx', startX);
  dotStart.setAttribute('cy', startY);
  dotEnd.setAttribute('cx', hCx);
  dotEnd.setAttribute('cy', hCy);
}

function nextStep() { goToStep(currentStep + 1); }
function prevStep() { goToStep(currentStep - 1); }

// Keyboard navigation
document.addEventListener('keydown', (e) => {
  if (document.getElementById('intro').classList.contains('hidden')) {
    if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextStep(); }
    if (e.key === 'ArrowLeft') { e.preventDefault(); prevStep(); }
  } else {
    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); startTutorial(); }
  }
});

// Recalculate arrow on resize
window.addEventListener('resize', () => {
  if (currentStep >= 0 && currentStep < STEPS.length) updateArrow(STEPS[currentStep]);
});

// ResizeObserver to recalculate arrow when wrapper dimensions change (image load, layout shift)
const resizeObserver = new ResizeObserver(() => {
  if (currentStep >= 0 && currentStep < STEPS.length) {
    requestAnimationFrame(() => updateArrow(STEPS[currentStep]));
  }
});
resizeObserver.observe(document.getElementById('screenshot-wrapper'));

init();
</script>
</body>
</html>
